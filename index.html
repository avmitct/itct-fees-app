<!doctype html>
<html lang="mr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>ITCT Admission System</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- HEADER -->
  <header class="header">
    <div class="header-inner">
      <img src="logo.jpg" alt="ITCT Logo" class="logo" onerror="this.style.display='none'">
      <div class="title">
        <div class="name">ITCT Computer Education</div>
        <div class="location">Nandurbar</div>
      </div>
    </div>
    <p class="sub">प्रवेश शुल्क प्रणाली</p>
  </header>

  <main>
    <!-- ========== LOGIN ========== -->
    <section id="login-section" class="card">
      <h2>Login</h2>
      <input id="login-username" placeholder="Username">
      <input id="login-password" type="password" placeholder="Password">
      <button id="login-btn">Login</button>
    </section>

    <!-- ========== MAIN APP ========== -->
    <section id="app-section" class="hidden">
      <!-- User bar -->
      <div id="user-bar" class="card user-bar">
        Logged in as: <span id="current-user-name"></span>
        (<span id="current-user-role"></span>)
      </div>
<button id="logout-btn" class="secondary">Logout</button>
</div>
      <!-- Toolbar -->
      <div class="toolbar">
        <button id="dashboard-btn">Dashboard</button>
        <button id="manage-courses-btn">Courses</button>
        <button id="add-student-btn">नवीन विद्यार्थी</button>
        <button id="reports-btn">Reports</button>
        <button id="backup-btn">Backup Export</button>
        <button id="restore-btn">Backup Import</button>
        <button id="settings-btn">Settings</button>
        <input id="file-input" type="file" accept=".json" style="display:none;">
      </div>

      <!-- Dashboard -->
      <section id="dashboard-section" class="card">
        <h3>Dashboard</h3>
        <div id="dash-total-students">Total students: 0</div>
        <div id="dash-total-fee">Total course fee: ₹0</div>
        <div id="dash-total-paid">Total paid: ₹0</div>
        <div id="dash-total-discount">Total discount: ₹0</div>
        <div id="dash-total-balance">Total balance: ₹0</div>
      </section>

      <!-- Courses -->
      <section id="courses-section" class="card hidden">
        <h3>Courses</h3>
        <div class="row">
          <input id="course-name" placeholder="Course name">
          <input id="course-fee" placeholder="Fee (₹)" type="number">
          <button id="add-course-btn">Add Course</button>
        </div>
        <ul id="courses-list"></ul>
      </section>

      <!-- Student form -->
      <section id="student-form" class="card hidden">
        <h3>विद्यार्थ्याची माहिती</h3>
        <input id="name" placeholder="नाव *">
        <input id="dob" placeholder="DOB (YYYY-MM-DD)">
        <input id="age" placeholder="वय">
        <input id="address" placeholder="पत्ता">
        <input id="mobile" placeholder="मोबाईल 1 *" maxlength="10">
        <input id="mobile2" placeholder="मोबाईल 2 (optional)" maxlength="10">
        <hr>
        <h4>पहिला Course</h4>
        <select id="course-select"></select>
        <input id="course-duedate" type="date" placeholder="Due date">
        <div class="row" style="margin-top:.5rem;">
          <button id="save-student-btn">जतन करा</button>
          <button id="cancel-student-btn" class="secondary">रद्द करा</button>
        </div>
      </section>

      <!-- Students list -->
      <section id="students-list" class="card">
        <h3>विद्यार्थी यादी</h3>
        <input id="search" placeholder="शोध... नाव / कोर्स / मोबाईल">
        <ul id="list"></ul>
      </section>

      <!-- Reports -->
      <section id="reports-section" class="card hidden">
        <h3>Reports</h3>
        <div class="row">
          <select id="report-course">
            <option value="">-- सर्व कोर्स --</option>
          </select>
          <input id="report-from" type="date">
          <input id="report-to" type="date">
        </div>
        <div class="row">
          <button id="generate-payment-report">Payment report</button>
          <button id="generate-balance-report">Balance report</button>
          <button id="generate-due-report">Due / Overdue report</button>
          <button id="export-csv">Export CSV (Excel)</button>
        </div>
        <div id="report-output"></div>
      </section>

      <!-- Settings -->
      <section id="settings-section" class="card hidden">
        <h3>Settings</h3>

        <!-- Change Admin Password -->
        <div class="settings-block">
          <h4>Change Admin Password</h4>
          <input id="new-pass" type="password" placeholder="New admin password">
          <button id="change-pass-btn">Change Password</button>
        </div>

        <!-- Add User -->
        <div class="settings-block">
          <h4>Add User</h4>
          <input id="new-user-username" placeholder="Username">
          <input id="new-user-password" type="password" placeholder="Password">
          <select id="new-user-role">
            <option value="data-entry">Data Entry</option>
            <option value="admin">Admin</option>
          </select>
          <button id="add-user-btn">Add User</button>
          <p class="note">टीप: Users localStorage मध्ये save होतात. फक्त Admin user नवीन users add करू शकतो.</p>
        </div>

        <!-- User List -->
        <div class="settings-block">
          <h4>User List</h4>
          <ul id="users-list"></ul>
          <p class="note">टीप: मुख्य admin user delete करता येणार नाही.</p>
        </div>
      </section>
    </section>
  </main>

  <!-- Template for student item -->
  <template id="student-item-tpl">
    <li class="student-item">
      <div class="info">
        <strong class="s-name"></strong>
        <div class="s-meta"></div>
      </div>
      <div class="actions">
        <button class="pay-btn">फीस भरा</button>
        <button class="view-btn">पहा</button>
        <button class="delete-btn admin-only">हटवा</button>
      </div>
    </li>
  </template>

  <!-- Modal -->
  <div id="modal" class="hidden" aria-hidden="true"></div>

  <!-- jsPDF (आता वापरत नाही, पण ठेवला तरी चालेल) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="app.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js').catch(()=>{});
    }
  </script>
</body>
</html>
