<!doctype html>
<html lang="mr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>ITCT Admission System (Cloud)</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- HEADER -->
  <header class="header">
    <div class="header-inner">
      <img src="logo.jpg" alt="ITCT Logo" class="logo" onerror="this.style.display='none'">
      <div class="title">
        <div class="name">ITCT Computer Education</div>
        <div class="location">Nandurbar</div>
      </div>
    </div>
    <p class="sub">Admission System ‚Äì Supabase Cloud</p>
  </header>

  <main>
    <!-- ========== LOGIN ========== -->
    <section id="login-section" class="card">
      <h2>Login</h2>
      <input id="login-username" placeholder="Username">
      <input id="login-password" type="password" placeholder="Password">
      <button id="login-btn">Login</button>
      
    </section>

    <!-- ========== MAIN APP ========== -->
    <section id="app-section" class="hidden">
      <!-- User bar -->
      <div id="user-bar" class="card user-bar">
        <div>
          Logged in as: <span id="current-user-name"></span>
          (<span id="current-user-role"></span>)
        </div>
        <button id="logout-btn" class="secondary">Logout</button>
      </div>

      <!-- Toolbar -->
      <div class="toolbar">
        <button id="dashboard-btn">Dashboard</button>
        <button id="manage-courses-btn">Courses</button>
        <button id="add-student-btn">‡§®‡§µ‡•Ä‡§® ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§∞‡•ç‡§•‡•Ä</button>
        <button id="students-list-btn">Student List</button>
        <button id="reports-btn">Reports</button>
        <button id="settings-btn">Settings</button>
        <button id="backup-btn" class="admin-only">Backup</button>
<section id="backup-section" class="card hidden">
  <h2>Backup Data</h2>
  <button id="backup-students">Download Students CSV</button>
  <button id="backup-fees">Download Fees CSV</button>
  <button id="backup-courses">Download Courses CSV</button>
</section>

      </div>

      <!-- Dashboard -->
      <section id="dashboard-section" class="card">
        <h3>Dashboard</h3>
        <div id="dash-total-students">Total students: 0</div>
        <div id="dash-total-fee">Total course fee: ‚Çπ0</div>
        <div id="dash-total-paid">Total paid: ‚Çπ0</div>
        <div id="dash-total-discount">Total discount: ‚Çπ0</div>
        <div id="dash-total-balance">Total balance: ‚Çπ0</div>
      </section>

      <!-- Courses -->
      <section id="courses-section" class="card hidden">
        <h3>Courses</h3>
        <div class="row">
          <input id="course-name" placeholder="Course name">
          <input id="course-fee" placeholder="Fee (‚Çπ)" type="number">
          <button id="add-course-btn">Add Course</button>
        </div>
        <ul id="courses-list"></ul>
      </section>

      <!-- Student form -->
      <section id="student-form" class="card hidden">
        <h3>‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§∞‡•ç‡§•‡•ç‡§Ø‡§æ‡§ö‡•Ä ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä</h3>
        <input id="name" placeholder="‡§®‡§æ‡§µ *">
        <input id="dob" placeholder="DOB (YYYY-MM-DD)">
        <input id="age" placeholder="‡§µ‡§Ø">
        <input id="address" placeholder="‡§™‡§§‡•ç‡§§‡§æ">
        <input id="mobile" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§à‡§≤ 1 *" maxlength="10">
        <input id="mobile2" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§à‡§≤ 2 (optional)" maxlength="10">
        <hr>
        <h4>Course ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä</h4>
        <select id="course-select"></select>
        <input id="course-duedate" type="date" placeholder="Due date">
        <div class="row" style="margin-top:.5rem;">
          <button id="save-student-btn">‡§ú‡§§‡§® ‡§ï‡§∞‡§æ</button>
          <button id="cancel-student-btn" class="secondary">‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡§æ</button>
        </div>
      </section>

      <!-- Students list -->
      <section id="students-list" class="card">
        <h3>‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§∞‡•ç‡§•‡•Ä ‡§Ø‡§æ‡§¶‡•Ä</h3>
        <input id="search" placeholder="‡§∂‡•ã‡§ß... ‡§®‡§æ‡§µ / ‡§ï‡•ã‡§∞‡•ç‡§∏ / ‡§Æ‡•ã‡§¨‡§æ‡§à‡§≤">
        <ul id="list"></ul>
      </section>

      <!-- Reports -->
      <section id="reports-section" class="card hidden">
        <h3>Reports</h3>
        <div class="row">
          <select id="report-course">
            <option value="">-- ‡§∏‡§∞‡•ç‡§µ ‡§ï‡•ã‡§∞‡•ç‡§∏ --</option>
          </select>
          <input id="report-from" type="date">
          <input id="report-to" type="date">
        </div>
        <div class="row">
          <button id="generate-payment-report">Payment report</button>
          <button id="generate-balance-report">Balance report</button>
          <button id="generate-due-report">Due / Overdue report</button>
          <button id="export-csv">Export CSV (Excel)</button>
        </div>
        <div id="report-output"></div>
      </section>

      <!-- Settings -->
      <section id="settings-section" class="card hidden">
        <h3>Settings</h3>
<section id="backup-section" class="card" style="display:none;">
  <h2>Backup Data</h2>
  <button id="backup-students">Download Students CSV</button>
  <button id="backup-fees">Download Fees CSV</button>
  <button id="backup-courses">Download Courses CSV</button>
</section>

        <!-- Change Admin Password -->
        <div class="settings-block">
          <h4>Change Admin Password</h4>
          <input id="new-pass" type="password" placeholder="New admin password">
          <button id="change-pass-btn">Change Password</button>
        </div>

        <!-- Add User -->
        <div class="settings-block">
          <h4>Add User</h4>
          <input id="new-user-username" placeholder="Username">
          <input id="new-user-password" type="password" placeholder="Password">
          <select id="new-user-role">
            <option value="data-entry">Data Entry</option>
            <option value="admin">Admin</option>
          </select>
          <button id="add-user-btn">Add User</button>
          <p class="note">‡§ü‡•Ä‡§™: Users Supabase database ‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§ú‡§§‡§® ‡§π‡•ã‡§§‡§æ‡§§. ‡§´‡§ï‡•ç‡§§ Admin user ‡§®‡§µ‡•Ä‡§® users add ‡§ï‡§∞‡•Ç ‡§∂‡§ï‡§§‡•ã.</p>
        </div>

        <!-- User List -->
        <div class="settings-block">
          <h4>User List</h4>
          <ul id="users-list"></ul>
          <p class="note">‡§ü‡•Ä‡§™: ‡§Æ‡•Å‡§ñ‡•ç‡§Ø admin user delete ‡§ï‡§∞‡§§‡§æ ‡§Ø‡•á‡§£‡§æ‡§∞ ‡§®‡§æ‡§π‡•Ä.</p>
        </div>
      </section>
    </section>
  </main>

  <!-- Template for student item -->
  <template id="student-item-tpl">
    <li class="student-item">
      <div class="info">
        <strong class="s-name"></strong>
        <div class="s-meta"></div>
      </div>
      <div class="actions">
        <button class="pay-btn">‡§´‡•Ä‡§∏ ‡§≠‡§∞‡§æ</button>
        <button class="view-btn">‡§™‡§π‡§æ</button>
        <button class="delete-btn admin-only">‡§π‡§ü‡§µ‡§æ</button>
      </div>
    </li>
  </template>

  <!-- Modal -->
  <div id="modal" class="hidden" aria-hidden="true"></div>

  <!-- Supabase JS (UMD) + client setup -->
  <script src="https://unpkg.com/@supabase/supabase-js@2.48.0/dist/umd/supabase.js"></script>
  <script>
    // üëâ ‡§á‡§•‡•á ‡§§‡•Å‡§Æ‡§ö‡•ç‡§Ø‡§æ Supabase ‡§ö‡§æ URL ‡§Ü‡§£‡§ø anon key ‡§ü‡§æ‡§ï‡§æ
    const SUPABASE_URL  = "https://lbepbdnoowbestqhfupm.supabase.co";
    const SUPABASE_ANON = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxiZXBiZG5vb3diZXN0cWhmdXBtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUwODMxMjcsImV4cCI6MjA4MDY1OTEyN30.wH-fEGF2Ni1iUkxmvzTy2A6Y5kTUmBUMPJKQMCxcYbE";

    window.supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON);
  </script>

  <script src="app.js"></script>
</body>
</html>
